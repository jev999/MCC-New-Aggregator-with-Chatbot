================================================================================
   SECURITY MONITORING & ACTIVITY LOGGING - QUICK START
================================================================================

Follow these steps to activate the monitoring and alerting system.

================================================================================
STEP 1: INSTALL ACTIVITY LOG PACKAGE
================================================================================

Run this command:

composer require spatie/laravel-activitylog

This will install the activity logging package.

================================================================================
STEP 2: RUN DATABASE MIGRATIONS
================================================================================

Run these migrations:

php artisan migrate

This creates:
âœ“ activity_log table (for activity logging)
âœ“ security_alerts table (for security monitoring)

================================================================================
STEP 3: PUBLISH CONFIGURATION (OPTIONAL)
================================================================================

To customize activity log settings:

php artisan vendor:publish --provider="Spatie\Activitylog\ActivitylogServiceProvider" --tag="activitylog-config"

This creates: config/activitylog.php

================================================================================
STEP 4: ADD SECURITY LOG CHANNEL
================================================================================

Edit: config/logging.php

Add this to the 'channels' array:

    'security' => [
        'driver' => 'daily',
        'path' => storage_path('logs/security.log'),
        'level' => 'warning',
        'days' => 90,
    ],

================================================================================
STEP 5: CLEAR CACHES
================================================================================

php artisan config:clear
php artisan cache:clear
php artisan optimize:clear

================================================================================
STEP 6: UPDATE LOGIN CONTROLLER
================================================================================

Add monitoring to your login/logout methods.
See SECURITY_MONITORING_GUIDE.txt Section 7.1 for complete code.

Key additions:
- Track failed login attempts
- Detect suspicious activity
- Log successful logins
- Clear failed attempts on success

================================================================================
STEP 7: UPDATE MIDDLEWARE
================================================================================

Add monitoring to CheckRole and CheckPermission middleware.
See SECURITY_MONITORING_GUIDE.txt Section 7.2 for complete code.

This logs all unauthorized access attempts.

================================================================================
STEP 8: TEST THE SYSTEM
================================================================================

1. Test Failed Login Detection:
   - Try logging in with wrong password 6 times
   - Check storage/logs/security.log
   - Check security_alerts table

2. Test Unauthorized Access:
   - Try accessing a route without permission
   - Check for security alert in database

3. Test Activity Logging:
   - Update an admin profile
   - Check activity_log table

4. Test Real-Time Alerts:
   - Trigger a critical alert
   - Check real-time alerts cache

================================================================================
VERIFICATION CHECKLIST
================================================================================

âœ“ spatie/laravel-activitylog package installed
âœ“ Migrations completed successfully
âœ“ activity_log table exists
âœ“ security_alerts table exists
âœ“ Security log channel configured
âœ“ Login controller updated with monitoring
âœ“ Middleware updated with monitoring
âœ“ Failed login attempts are logged
âœ“ Unauthorized access attempts are logged
âœ“ Activity log working on model changes
âœ“ Security alerts appearing in database

================================================================================
USAGE EXAMPLES
================================================================================

1. Detect Suspicious Activity:
   -------------------------------
   use App\Services\SecurityMonitoringService;
   
   $monitor = app(SecurityMonitoringService::class);
   $monitor->detectSuspiciousActivity('login_failed', [
       'ip' => $request->ip(),
       'username' => $request->username,
   ], 'high');

2. Log Activity:
   --------------
   activity()
       ->causedBy(auth('admin')->user())
       ->performedOn($model)
       ->log('Action performed');

3. Get Security Stats:
   --------------------
   $stats = $monitor->getSecurityStatistics();

4. Get Real-Time Alerts:
   ----------------------
   $alerts = $monitor->getRealtimeAlerts(20);

5. Resolve Alert:
   ---------------
   $monitor->resolveAlert($alertId, auth('admin')->id());

================================================================================
MONITORING FEATURES
================================================================================

âœ“ Failed Login Detection (>5 attempts)
âœ“ Unauthorized Access Monitoring
âœ“ Unusual Time Access Detection (outside 8 AM - 6 PM)
âœ“ Unusual Location Detection (IP tracking)
âœ“ Rapid-Fire Request Detection (>30/min)
âœ“ Privilege Escalation Detection
âœ“ Bulk Operation Monitoring (>100 items)
âœ“ Critical System Change Tracking
âœ“ Multiple Account Access Detection
âœ“ Session Hijacking Detection

âœ“ Activity Logging for All Models
âœ“ Admin Action Tracking
âœ“ Data Modification History
âœ“ Real-Time Alert System
âœ“ Severity-Based Alerts (Critical, High, Medium, Low)
âœ“ Email Notifications (Critical/High)
âœ“ 1-Year Data Retention
âœ“ Comprehensive Reporting
âœ“ Campus System Compliance

================================================================================
CAMPUS SYSTEM LOGS
================================================================================

All logs include:
âœ“ Timestamp
âœ“ Admin ID/Username
âœ“ IP Address
âœ“ User Agent
âœ“ Action Type
âœ“ Resource Accessed
âœ“ Success/Failure Status
âœ“ Before/After Values (for updates)

Log Retention:
âœ“ Activity logs: 365 days (1 year)
âœ“ Security logs: 90 days
âœ“ Security alerts: Indefinite (or until resolved + 90 days)

================================================================================
ALERT SEVERITY LEVELS
================================================================================

CRITICAL ðŸ”´
- Session hijacking detected
- Privilege escalation attempts
- Immediate action required
- Email alerts sent

HIGH ðŸŸ 
- Multiple failed logins
- Rapid-fire requests
- Bulk operations (>100 items)
- Email alerts sent

MEDIUM ðŸŸ¡
- Unusual time access
- Unauthorized access attempts
- New IP location
- Logged for review

LOW ðŸ”µ
- Informational
- Pattern monitoring
- Logged for analysis

================================================================================
TROUBLESHOOTING
================================================================================

Problem: Activity log not working
Solution: Ensure model has LogsActivity trait and getActivitylogOptions() method

Problem: No security alerts
Solution: Check SecurityAlert model exists and migration ran

Problem: Failed login not detected
Solution: Verify SecurityMonitoringService is injected and called

Problem: Cache issues
Solution: Run php artisan cache:clear

Problem: Logs not appearing
Solution: Check storage/logs permissions (775) and ownership

================================================================================
NEXT STEPS
================================================================================

1. Create Security Monitoring Dashboard
2. Implement Alert Resolution Interface
3. Add Email Notification Templates
4. Configure Business Hours for Your Campus
5. Set Up Automated Reports
6. Train Administrators on Alert System
7. Document Security Procedures
8. Test Alert System Thoroughly
9. Review and Adjust Detection Thresholds
10. Implement Automated Cleanup Jobs

================================================================================
SUPPORT FILES
================================================================================

ðŸ“„ SECURITY_MONITORING_GUIDE.txt
   - Complete implementation guide
   - Code examples
   - Integration instructions

ðŸ“„ app/Services/SecurityMonitoringService.php
   - Core monitoring service
   - Suspicious activity detection
   - Alert management

ðŸ“„ app/Models/SecurityAlert.php
   - Security alert model
   - Query scopes
   - Relationships

ðŸ“„ database/migrations/2025_11_12_000001_create_security_alerts_table.php
   - Security alerts table schema

================================================================================
MAINTENANCE SCHEDULE
================================================================================

DAILY:
- Review unresolved alerts
- Check critical alerts
- Monitor failed login attempts

WEEKLY:
- Generate security report
- Review activity logs
- Check for patterns

MONTHLY:
- Comprehensive security audit
- Update detection thresholds
- Clean old resolved alerts

QUARTERLY:
- Review and update policies
- Train administrators
- Test disaster recovery

ANNUALLY:
- Full security review
- Update compliance documentation
- Archive old logs

================================================================================
COMPLIANCE & REPORTING
================================================================================

The system provides all logs required for:
âœ“ Campus security policies
âœ“ Data protection regulations
âœ“ Audit trails
âœ“ Incident investigation
âœ“ Compliance reporting

Reports can be generated for:
âœ“ Failed login attempts
âœ“ Unauthorized access attempts
âœ“ Admin actions
âœ“ Data modifications
âœ“ System changes
âœ“ Security incidents

================================================================================
END OF QUICK START GUIDE
================================================================================

For detailed information, see SECURITY_MONITORING_GUIDE.txt

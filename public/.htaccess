<IfModule mod_rewrite.c>
    <IfModule mod_negotiation.c>
        Options -MultiViews -Indexes
    </IfModule>

    RewriteEngine On

    # -----------------------------
    # ðŸ”’ Security Headers
    # -----------------------------
    <IfModule mod_headers.c>
        # Enforce HTTPS for 1 year
        Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

        # Prevent Clickjacking
        Header always set X-Frame-Options "SAMEORIGIN"

        # Prevent MIME type sniffing
        Header always set X-Content-Type-Options "nosniff"

        # XSS Protection (legacy)
        Header always set X-XSS-Protection "1; mode=block"

        # Control referrer info
        Header always set Referrer-Policy "strict-origin-when-cross-origin"

        # Limit browser permissions
        Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), fullscreen=(self), picture-in-picture=(self)"
    </IfModule>

    # -----------------------------
    # ðŸ§© Authorization Headers
    # -----------------------------
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # -----------------------------
    # âœ… Laravel Front Controller
    # -----------------------------
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]

    # -----------------------------
    # âœ… Hide .php Extension (Safe)
    # Example: /about â†’ /about.php
    # Works only if file physically exists
    # -----------------------------
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteRule ^(.+?)/?$ $1.php [L,QSA]

    # -----------------------------
    # ðŸš« Redirect .php URLs to clean URLs
    # Example: /contact.php â†’ /contact
    # -----------------------------
    RewriteCond %{THE_REQUEST} \s/([^\s?]+)\.php[?\s] [NC]
    RewriteRule ^ %1 [R=301,L]
</IfModule>

================================================================================
    BACKUP SYSTEM - QUICK FIX GUIDE
    For: https://mcc-nac.com/superadmin/backup
================================================================================

üöÄ FASTEST FIX (Do These First):
================================================================================

1Ô∏è‚É£ ADD TO .ENV FILE ON LIVE SERVER:
   USE_PHP_BACKUP=true

2Ô∏è‚É£ FIX PERMISSIONS (via SSH or cPanel):
   chmod -R 775 storage
   chmod -R 775 bootstrap/cache

3Ô∏è‚É£ UPLOAD UPDATED FILES:
   ‚úì app/Http/Controllers/BackupController.php
   ‚úì app/Services/DatabaseBackupService.php
   
4Ô∏è‚É£ REPLACE .HTACCESS:
   Rename .htaccess.production to .htaccess

5Ô∏è‚É£ CLEAR CACHE (via SSH):
   php artisan cache:clear
   php artisan config:clear

6Ô∏è‚É£ TEST BACKUP AGAIN


================================================================================
üîç DIAGNOSTIC TOOLS (If above doesn't work):
================================================================================

Upload these to server root and access via browser:

1. test-backup-diagnostic.php?key=mcc-diagnostic-2024
   ‚Üí Shows all system issues

2. fix-backup-directories.php?key=mcc-fix-2024
   ‚Üí Automatically fixes directory permissions

‚ö†Ô∏è DELETE BOTH FILES AFTER USE!


================================================================================
üìù CHECK LOGS:
================================================================================

Download and check:
storage/logs/laravel.log

Look for lines containing:
- "Backup"
- "DatabaseBackupService"
- "Failed"

The error message will tell you exactly what's wrong.


================================================================================
‚úÖ EXPECTED BEHAVIOR AFTER FIX:
================================================================================

1. Click "Create Manual Backup" button
2. Loading spinner appears
3. Success message: "Database backup created successfully!"
4. New backup file appears in Backup History table
5. Can download the backup file


================================================================================
‚ùì COMMON ERRORS & QUICK SOLUTIONS:
================================================================================

ERROR: "Failed to create backup"
‚Üí Run fix-backup-directories.php
‚Üí Or chmod 775 storage

ERROR: "Directory not writable"
‚Üí chmod -R 775 storage
‚Üí Check storage ownership

ERROR: "Maximum execution time"
‚Üí Update .htaccess with .htaccess.production
‚Üí Or increase max_execution_time in cPanel

ERROR: "Out of memory"
‚Üí Update .htaccess with .htaccess.production
‚Üí Or increase memory_limit in cPanel

ERROR: "Cannot connect to database"
‚Üí Check DB credentials in .env file


================================================================================
üìû WHAT TO SEND IF YOU NEED HELP:
================================================================================

1. Output from test-backup-diagnostic.php
2. Last 50 lines from storage/logs/laravel.log
3. Your PHP version (from cPanel or phpinfo)
4. Exact error message from browser console


================================================================================
For full troubleshooting guide, see:
BACKUP_TROUBLESHOOTING_GUIDE.txt
================================================================================
